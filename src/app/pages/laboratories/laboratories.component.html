<div>
  <div class="mb-5">
    <h5 class="font-semibold text-lg dark:text-white-light">Laboratórios</h5>
    <p class="text-gray-500 dark:text-gray-400">Gerencie e visualize todos os laboratórios disponíveis</p>
  </div>

  <div class="mb-6">
    <div class="w-full sm:w-[calc(50%-12px)] lg:w-[calc(33.333%-16px)] xl:w-[calc(25%-18px)]">
      <app-search-input
        placeholder="Buscar laboratórios..."
        [value]="searchTerm"
        (searchChange)="onSearchChange($event)"
        (search)="onSearch($event)">
      </app-search-input>
    </div>
  </div>

  <div *ngIf="filteredLaboratories.length > 0" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
    <div
      *ngFor="let laboratory of filteredLaboratories"
      class="bg-white shadow-[4px_6px_10px_-3px_#bfc9d4] rounded border border-[#e0e6ed] dark:border-[#1b2e4b] dark:bg-[#191e3a] dark:shadow-none flex flex-col h-full">
      
      <div class="p-6">
        <div class="flex items-start justify-between mb-4">
          <div class="flex-1">
            <h5 class="text-secondary text-[15px] font-bold dark:text-white-light uppercase mb-2">
              {{ laboratory.name }}
            </h5>
            <span 
              class="badge w-16 text-[10px] text-center"
              [ngClass]="laboratory.active ? 'bg-success' : 'bg-danger'">
              {{ getStatusText(laboratory.active) }}
            </span>
          </div>
          <div class="flex-shrink-0 ml-3">
            <div class="w-10 h-10 bg-primary-light dark:bg-primary-dark-light rounded-lg flex items-center justify-center">
              <icon-laboratory class="w-5 h-5 text-primary"></icon-laboratory>
            </div>
          </div>
        </div>


        <div class="py-3 relative justify-between text-[12px] before:w-[100%] before:h-[1px] before:bg-[#e0e6ed] before:inset-x-0 before:top-0 before:absolute before:mx-auto dark:before:bg-[#1b2e4b]">
          <div class="flex justify-between items-center font-semibold">
            <div class="text-dark">
              <div class="flex items-center mb-2">
                <icon-location class="w-4 h-4 text-primary mr-2"></icon-location>
                <span class="font-bold text-gray-400">Endereço</span>
              </div>
              <div class="ml-6 space-y-1">
                <p class="text-gray-400"><span class="font-semibold">Rua:</span> {{ laboratory.address_street }}, {{ laboratory.address_number }}</p>
                <p class="text-gray-400" *ngIf="laboratory.address_complement"><span class="font-semibold">Complemento:</span> {{ laboratory.address_complement }}</p>
                <p class="text-gray-400"><span class="font-semibold">Bairro:</span> {{ laboratory.address_neighborhood }}</p>
                <p class="text-gray-400"><span class="font-semibold">Cidade:</span> {{ laboratory.address_city }}</p>
                <p class="text-gray-400"><span class="font-semibold">Estado:</span> {{ laboratory.address_state }}</p>
                <p class="text-gray-400"><span class="font-semibold">CEP:</span> {{ laboratory.address_postal_code }}</p>
                <p class="text-gray-400"><span class="font-semibold">País:</span> {{ laboratory.address_country }}</p>
              </div>
            </div>
          </div>
        </div>

        <div class="py-3 relative justify-between text-[12px] before:w-[100%] before:h-[1px] before:bg-[#e0e6ed] before:inset-x-0 before:top-0 before:absolute before:mx-auto dark:before:bg-[#1b2e4b]">
          <div class="flex justify-between items-center font-semibold">
            <div class="text-dark">
              <div class="flex items-center">
                <icon-phone class="w-4 h-4 text-primary mr-2"></icon-phone>
                <span class="font-bold text-gray-400">Telefone:</span>
                <span class="text-gray-400 ml-2">{{ laboratory.phone_number }}</span>
              </div>
            </div>
          </div>
        </div>

        <div class="py-3 relative justify-between text-[12px] before:w-[100%] before:h-[1px] before:bg-[#e0e6ed] before:inset-x-0 before:top-0 before:absolute before:mx-auto dark:before:bg-[#1b2e4b]">
          <div class="flex justify-between items-center font-semibold">
            <div class="text-dark">
              <div class="flex items-center">
                <icon-email class="w-4 h-4 text-primary mr-2"></icon-email>
                <span class="font-bold text-gray-400">E-mail:</span>
                <span class="text-gray-400 ml-2">{{ laboratory.email }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="flex my-4 justify-center items-center mt-auto">
        <button 
          class="btn btn-primary"
          (click)="agendarExame(laboratory)">
          Ver Detalhes
        </button>
      </div>
    </div>
  </div>

  <!-- Estado vazio quando não há resultados da pesquisa -->
  <div *ngIf="filteredLaboratories.length === 0 && searchTerm" class="text-center py-12">
    <div class="mx-auto h-24 w-24 text-gray-400">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
      </svg>
    </div>
    <h3 class="mt-4 text-lg font-medium text-gray-900 dark:text-white">Nenhum laboratório encontrado</h3>
    <p class="mt-2 text-gray-500 dark:text-gray-400">
      Não encontramos laboratórios para "<span class="font-medium">{{ searchTerm }}</span>"
    </p>
    <button
      (click)="searchTerm = ''; filterLaboratories()"
      class="mt-4 text-primary hover:text-primary-dark font-medium transition-colors">
      Limpar pesquisa
    </button>
  </div>
</div>
